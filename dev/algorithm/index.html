<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Brief description of the algorithm · SpinGlassPEPS.jl</title><meta name="title" content="Brief description of the algorithm · SpinGlassPEPS.jl"/><meta property="og:title" content="Brief description of the algorithm · SpinGlassPEPS.jl"/><meta property="twitter:title" content="Brief description of the algorithm · SpinGlassPEPS.jl"/><meta name="description" content="Documentation for SpinGlassPEPS.jl."/><meta property="og:description" content="Documentation for SpinGlassPEPS.jl."/><meta property="twitter:description" content="Documentation for SpinGlassPEPS.jl."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">SpinGlassPEPS.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../intro/">Getting started</a></li><li class="is-active"><a class="tocitem" href>Brief description of the algorithm</a><ul class="internal"><li><a class="tocitem" href="#Problem-representation"><span>Problem representation</span></a></li><li><a class="tocitem" href="#Graphs-with-large-unit-cells"><span>Graphs with large unit cells</span></a></li><li><a class="tocitem" href="#Calculating-conditional-probabilities"><span>Calculating conditional probabilities</span></a></li><li><a class="tocitem" href="#Branch-and-bound-search"><span>Branch and bound search</span></a></li><li><a class="tocitem" href="#Tensor-network-contractions-for-optimization-problems"><span>Tensor network contractions for optimization problems</span></a></li><li><a class="tocitem" href="#References-and-Related-works"><span>References &amp; Related works</span></a></li></ul></li><li><a class="tocitem" href="../examples/">More examples</a></li><li><span class="tocitem">SpinGlassNetworks</span><ul><li><a class="tocitem" href="../sgn/userguide/">User guide</a></li><li><a class="tocitem" href="../sgn/ising/">Ising graph</a></li><li><a class="tocitem" href="../sgn/lattice/">Lattice geometries</a></li><li><a class="tocitem" href="../sgn/clh/">Potts hamiltonian</a></li><li><a class="tocitem" href="../sgn/bp/">Local dimensional reduction</a></li></ul></li><li><span class="tocitem">SpinGlassEngine</span><ul><li><a class="tocitem" href="../sge/guide/">User Guide</a></li><li><a class="tocitem" href="../sge/peps/">Tensor network</a></li><li><a class="tocitem" href="../sge/params/">Search parameters</a></li><li><a class="tocitem" href="../sge/search/">Low energy spectrum</a></li></ul></li><li><span class="tocitem">SpinGlassTensors</span><ul><li><a class="tocitem" href="../sgt/">User guide</a></li><li><a class="tocitem" href="../sgt/mpo/">Matrix Product States and Matrix Product Operations</a></li><li><a class="tocitem" href="../sgt/api/">API Reference</a></li></ul></li><li><a class="tocitem" href="../examples/">More examples</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Brief description of the algorithm</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Brief description of the algorithm</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/euro-hpc-pl/SpinGlassPEPS.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/euro-hpc-pl/SpinGlassPEPS.jl/blob/master/docs/src/algorithm.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Brief-description-of-the-algorithm"><a class="docs-heading-anchor" href="#Brief-description-of-the-algorithm">Brief description of the algorithm</a><a id="Brief-description-of-the-algorithm-1"></a><a class="docs-heading-anchor-permalink" href="#Brief-description-of-the-algorithm" title="Permalink"></a></h1><p><code>SpinGlassPEPS.jl</code> is a package developed for finding low-energy configurations in Ising type optimization problems [1, 2]. By leveraging Projected Entangled Pair States (PEPS) tensor networks, the algorithm efficiently represents the Boltzmann distribution [5], enabling heuristic exploration of quasi-2D problem spaces. In particular, this approach is tailored to tackle the challenges posed by graph geometries relevant to modern quantum annealing devices, such as the Pegasus and Zephyr graphs employed by D-Wave systems.</p><p>This section builds upon the broader methodology outlined in the analysis of tensor-network limitations in solving large-scale Ising problems on Pegasus and Zephyr geometries​ [1].</p><h2 id="Problem-representation"><a class="docs-heading-anchor" href="#Problem-representation">Problem representation</a><a id="Problem-representation-1"></a><a class="docs-heading-anchor-permalink" href="#Problem-representation" title="Permalink"></a></h2><p>Let us consider a classical Ising Hamiltonian</p><p class="math-container">\[H(\underline{s}_N) =  \sum_{\langle i, j\rangle \in \mathcal{E}} J_{ij} s_i s_j + \sum_{i =1}^N J_{ii} s_i\]</p><p>where <span>$\underline{s}_N$</span> denotes a particular configuration of <span>$N$</span> binary variables <span>$s_i=\pm 1$</span>. More generally, we  mark sub-configurations of the first <span>$k$</span> variables as <span>$\underline{s}_k = (s_1, s_2, \ldots, s_k)$</span>. Non-zero couplings <span>$J_{ij} \in \mathbb{R}$</span> are input parameters of a given problem instance and form a connectivity graph <span>$\mathcal{E}$</span>.</p><h2 id="Graphs-with-large-unit-cells"><a class="docs-heading-anchor" href="#Graphs-with-large-unit-cells">Graphs with large unit cells</a><a id="Graphs-with-large-unit-cells-1"></a><a class="docs-heading-anchor-permalink" href="#Graphs-with-large-unit-cells" title="Permalink"></a></h2><p>We focus on the systems with quasi-2D interaction graphs, in particular those of the relevance to present-day quantum annealers, such as Pegasus and Zephyr. In the picture below, we mark group of spins which naturally form unit cells with red shapes.</p><div class="admonition is-info"><header class="admonition-header">Info</header><div class="admonition-body"><p>More information on lattice geometries you can find in section <a href="../sgn/lattice/">Lattice Geometries</a>.</p></div></div><img src="../images/lattice.png" width="200%" class="center"/><p>In order to adress graph geometries with large unit cells using tensor networks, we represent the problem as a Potts Hamiltonian. To that end we group together sets of binary variables into clusters with a reduced number of variables of larger dimensions. In this framework Ising problem translates to:</p><p class="math-container">\[H(\underline{x}_{\bar{N}}) = \sum_{\langle m,n\rangle \in \mathcal{F}} E_{x_m x_n} + \sum_{n=1}^{\bar{N}} E_{x_n}\]</p><p>where <span>$\mathcal{F}$</span> forms a 2D graph, in which we indicate nearest-neighbour interactions with blue lines, and diagonal connections with green lines in the picture above. In this example, <span>$x_n$</span> takes <span>$d$</span> values with  <span>$d=2^4$</span> for square diagonal, <span>$d=2^{24}$</span> for Pegasus and <span>$2^{16}$</span> for Zephyr geometry (in the maximal case when all qubits are operational).  <span>$E_{x_n}$</span> is an intra-node energy of the corresponding binary-variables configuration, and <span>$E_{x_n x_m}$</span> is inter-node energy.</p><img src="../images/clustering.png" width="200%" class="center"/><h2 id="Calculating-conditional-probabilities"><a class="docs-heading-anchor" href="#Calculating-conditional-probabilities">Calculating conditional probabilities</a><a id="Calculating-conditional-probabilities-1"></a><a class="docs-heading-anchor-permalink" href="#Calculating-conditional-probabilities" title="Permalink"></a></h2><p>We assume that finding low energy states is equivalent to finding most probable states. We represent the probability distribution as a PEPS tensor network.</p><p class="math-container">\[    p(\underline{x}_{\bar{N}}) = \frac{1}{Z} \exp{(-\beta H(\underline{x}_{\bar{N}}))}\]</p><p>where <span>$Z$</span> is a partition function and <span>$\beta$</span> is inverse temperature. Once the PEPS tensor network is constructed, the probability distribution can be obtained by approximately contracting the tensor network, which is described in more details in subsection <a href="#Tensor-network-contractions-for-optimization-problems">Tensor network contractions for optimization problems</a>. Subsequently, we select only the configurations with the highest marginal probabilities</p><p class="math-container">\[    p(\underline{x}_{n+1}) = p(x_{n+1} | \underline{x}_{n}) \times p(\underline{x}_{n})\]</p><h2 id="Branch-and-bound-search"><a class="docs-heading-anchor" href="#Branch-and-bound-search">Branch and bound search</a><a id="Branch-and-bound-search-1"></a><a class="docs-heading-anchor-permalink" href="#Branch-and-bound-search" title="Permalink"></a></h2><p>By employing branch and bound search strategy iteratively row after row, we address the solution of Hamiltonian in the terms of conditional probabilities. This approach enables the identification of most probable (low-energy) spin configurations within the problem space. </p><img src="../images/bb.png" width="200%" class="center"/><h2 id="Tensor-network-contractions-for-optimization-problems"><a class="docs-heading-anchor" href="#Tensor-network-contractions-for-optimization-problems">Tensor network contractions for optimization problems</a><a id="Tensor-network-contractions-for-optimization-problems-1"></a><a class="docs-heading-anchor-permalink" href="#Tensor-network-contractions-for-optimization-problems" title="Permalink"></a></h2><p>Branch and bound search relies on the calculation of conditional probabilities. To that end, we use tensor network techniques. Conditional probabilities are obtained by contracting a PEPS tensor network, which, although an NP-hard problem, can be computed approximately. The approach utilized in <code>SpinGlassPEPS.jl</code> is boundary matrix product state (MPS) illustrated in the figure below. Tensors in the pink box are approximated by matrix product state with truncated bond dimension. In each step, a product of boundary MPS from the previous row and the matrix product operator (MPO) formed by the next row of tensors, is approximated by a new boundary MPS of limited bond dimension. </p><div class="admonition is-info"><header class="admonition-header">Info</header><div class="admonition-body"><p>In <code>SpinGlassPEPS.jl</code> one can use two types of approximating boundary MPS. More information you can find in the section <a href="../sge/params/">Search parameters</a>.</p></div></div><img src="../images/prob.png" width="150%" class="center"/><img src="../images/explain.png" width="75%" class="center"/><h2 id="References-and-Related-works"><a class="docs-heading-anchor" href="#References-and-Related-works">References &amp; Related works</a><a id="References-and-Related-works-1"></a><a class="docs-heading-anchor-permalink" href="#References-and-Related-works" title="Permalink"></a></h2><ol><li><p>&quot;Limitations of tensor network approaches for optimization and sampling: A comparison against quantum and classical Ising machines&quot; A.M. Dziubyna, T. Śmierzchalski, B. Gardas, M.M. Rams, M. Mohseni <a href="https://arxiv.org/abs/2411.16431">arXiv:2411.16431</a></p></li><li><p>&quot;SpinGlassPEPS.jl: low-energy solutions for near-term quantum annealers&quot; T. Śmierzchalski, A.M. Dziubyna, K. Jałowiecki, Z. Mzaouali, Ł. Pawela, B. Gardas, M.M. Rams []</p></li><li><p>&quot;Approximate optimization, sampling, and spin-glass droplet discovery with tensor networks&quot; Marek M. Rams, Masoud Mohseni, Daniel Eppens, Konrad Jałowiecki, Bartłomiej Gardas <a href="https://journals.aps.org/pre/abstract/10.1103/PhysRevE.104.025308">Phys. Rev. E 104, 025308 (2021)</a> or arXiv version <a href="https://arxiv.org/abs/1811.06518">arXiv:1811.06518</a></p></li><li><p><a href="https://github.com/marekrams/tnac4o/tree/master">tnac4o</a></p></li><li><p>&quot;Two-Dimensional Tensor Product Variational Formulation&quot; T. Nishino, Y. Hieida, K. Okunishi, N. Maeshima, Y. Akutsu, A. Gendiar, <a href="https://academic.oup.com/ptp/article/105/3/409/1834124">Progr. Theor. Phys. 105, 409 (2001)</a></p></li></ol></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../intro/">« Getting started</a><a class="docs-footer-nextpage" href="../examples/">More examples »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.8.0 on <span class="colophon-date" title="Thursday 23 January 2025 18:16">Thursday 23 January 2025</span>. Using Julia version 1.11.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
